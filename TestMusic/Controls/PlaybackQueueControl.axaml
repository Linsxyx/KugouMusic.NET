<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:TestMusic.ViewModels"
             xmlns:suki="https://github.com/kikipoulet/SukiUI"
             x:Class="TestMusic.Controls.PlaybackQueueControl"
             x:DataType="vm:MainWindowViewModel">

    <suki:GlassCard CornerRadius="15" Margin="5" IsOpaque="True">
        <Grid RowDefinitions="Auto, *">
            <Grid Grid.Row="0" ColumnDefinitions="*, Auto" Margin="15,10">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <TextBlock Text="播放队列" FontWeight="Bold" FontSize="16" VerticalAlignment="Center" />
                    <TextBlock Text="{Binding Player.PlaybackQueue.Count, StringFormat='({0})'}"
                               FontSize="12" VerticalAlignment="Center" />
                </StackPanel>
                <Button Grid.Column="1" Classes="Basic" Content="清空"
                        Command="{Binding Player.ClearQueueCommand}"
                        FontSize="12" Foreground="{DynamicResource SukiPrimaryColor}" />
            </Grid>

            <ListBox Grid.Row="1"
                     ItemsSource="{Binding Player.PlaybackQueue}"
                     BorderThickness="0">
                <ListBox.Styles>
                    <Style Selector="ListBoxItem">
                        <Setter Property="Padding" Value="12,10" />
                        <Setter Property="CornerRadius" Value="10" />
                        <Setter Property="Margin" Value="6,4" />
                        <Setter Property="Background" Value="Transparent" />
                        <Setter Property="Cursor" Value="Hand" />
                    </Style>
                </ListBox.Styles>
                <ListBox.ItemTemplate>
                    <DataTemplate DataType="vm:SongItem">
                        <Grid ColumnDefinitions="*, Auto">
                            <StackPanel Spacing="2">
                                <TextBlock Text="{Binding Name}"
                                           FontWeight="{Binding IsPlaying}"
                                           Foreground="{Binding IsPlaying}" />
                                <TextBlock Text="{Binding Singer}" FontSize="11" />
                            </StackPanel>

                            <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                                <Button Classes="Basic"
                                        Command="{Binding $parent[suki:SukiWindow].((vm:MainWindowViewModel)DataContext).Player.PlaySongCommand}"
                                        CommandParameter="{Binding .}">
                                    <TextBlock Text="▶" FontSize="10" />
                                </Button>
                                <Button Classes="Basic"
                                        Command="{Binding $parent[suki:SukiWindow].((vm:MainWindowViewModel)DataContext).Player.RemoveFromQueueCommand}"
                                        CommandParameter="{Binding .}">
                                    <TextBlock Text="✕" FontSize="10" />
                                </Button>
                            </StackPanel>
                        </Grid>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>
        </Grid>
    </suki:GlassCard>
</UserControl>